<html>
    <head>
<script type="text/javascript" src="third-party\glMatrix-0.9.5.min.js"></script>
<script type="text/javascript" src="third-party\jquery-1.9.1.js"></script>
<script type="text/javascript" src="Game\Engine.js"></script>
<script type="text/javascript" src="Game\Renderer.js"></script>
<script type="text/javascript" src="Game\Renderable.js"></script>
<script type="text/javascript" src="Game\Collection.js"></script>
<script type="text/javascript" src="Game\Crates.js"></script>
<script type="text/javascript" src="Game\Camera.js"></script>

        <script type="text/javascript">
            var engine;

            $(document).ready(function(){
                engine = new Engine("canvas");
                
                var crates = new Crates(engine.renderer);
                engine.addItem(crates);

                $(canvas).mousedown(handleMouseDown);
                document.onmouseup = handleMouseUp;
                document.onmousemove = handleMouseMove;
                $(canvas).bind("mousewheel", handleZoom);
            });

            

            var mouseDown = false;
            var lastMouseX = null;
            var lastMouseY = null;

            function handleMouseDown(event) {
                mouseDown = true;
                lastMouseX = event.clientX;
                lastMouseY = event.clientY;
                $("#canvas").css({cursor: "none"});
            }

            function handleMouseUp(event) {
                mouseDown = false;
                $("#canvas").css("cursor", "pointer");
            }

            function handleMouseMove(event) {
                if (!mouseDown) {
                    return;
                }
                var newX = event.clientX;
                var newY = event.clientY;

                var deltaX = newX - lastMouseX;
                engine.renderer.camera.yaw += deltaX;

                var deltaY = newY - lastMouseY;
                engine.renderer.camera.pitch -= deltaY;
                lastMouseX = newX
                lastMouseY = newY;
            }

            function handleZoom(event){
                if(event.originalEvent.wheelDelta > 0){
                    engine.renderer.camera.z -= 5;
                    if(engine.renderer.camera.z < engine.renderer.camera.focusZ + 15.0){
                        engine.renderer.camera.z = engine.renderer.camera.focusZ + 15.0;
                    }
                } else {
                    engine.renderer.camera.z += 5;
                    if(engine.renderer.camera.z > engine.renderer.camera.focusZ + 215.0){
                        engine.renderer.camera.z = engine.renderer.camera.focusZ + 215.0;
                    }
                }

                return false;
            }

        </script>
    </head>
    <body style="margin: 0; padding: 0; border: 0;">
        <canvas id="canvas" style="border: none; width: 100%; height: 100%;" width=1920 height=900></canvas>
    </body>
</html>

